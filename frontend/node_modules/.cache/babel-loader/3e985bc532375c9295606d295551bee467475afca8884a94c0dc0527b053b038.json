{"ast":null,"code":"import _objectSpread from\"C:/Users/Admin/Desktop/stock/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useState}from\"react\";import{transferBook,returnBook,Blanks_LIMIT}from\"../../requests\";import Close from\"../../images/icon-close.png\";import Change from\"../../images/icon-change.png\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function InnerCard(_ref){let{data,dataAll,setDataAll,readerData,countIssuedBlanks,hasIssuedBook}=_ref;const{blank_id,material_name,part_name}=data;const{supplier_id,supplier_name}=readerData;const[shown,setShown]=useState(false);const[newData,setNewData]=useState({supplier_id:supplier_id,new_supplier_id:null,blank_id:blank_id});const handleDeleteInnerCard=async()=>{if(window.confirm(\"\\u0412\\u044B \\u0443\\u0432\\u0435\\u0440\\u0435\\u043D\\u044B, \\u0447\\u0442\\u043E \\u0445\\u043E\\u0442\\u0438\\u0442\\u0435 \\u043F\\u0440\\u0438\\u043D\\u044F\\u0442\\u044C \\u0437\\u0430\\u0433\\u043E\\u0442\\u043E\\u0432\\u043A\\u0443 \\\"\".concat(part_name,\"\\\" \\u043E\\u0442 \\u043F\\u043E\\u0441\\u0442\\u0430\\u0432\\u0449\\u0438\\u043A\\u0430 \").concat(supplier_name,\"?\"))){const res=await returnBook(newData);if(res){window.location.reload();}}};const handleSubmit=async e=>{e.preventDefault();const res=await transferBook(newData);if(res===200){setShown(false);window.location.reload();}};const handleChange=e=>{const{name,value}=e.target;if(countIssuedBlanks(value)>=Blanks_LIMIT){alert(\"\\u041A\\u043E\\u043B\\u0438\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E \\u0437\\u0430\\u0433\\u043E\\u0442\\u043E\\u0432\\u043E\\u043A \\u0432 \\u043F\\u043E\\u0441\\u0442\\u0430\\u0432\\u043A\\u0435 \\u0443 \\u0432\\u044B\\u0431\\u0440\\u0430\\u043D\\u043D\\u043E\\u0433\\u043E \\u0447\\u0435\\u043B\\u043E\\u0432\\u0435\\u043A\\u0430 \\u043F\\u0440\\u0435\\u0432\\u044B\\u0448\\u0430\\u0435\\u0442 \\u043B\\u0438\\u043C\\u0438\\u0442 \".concat(Blanks_LIMIT,\".\"));return;}if(hasIssuedBook(value,blank_id)){alert(\"\\u0423 \\u0432\\u044B\\u0431\\u0440\\u0430\\u043D\\u043D\\u043E\\u0433\\u043E \\u0447\\u0435\\u043B\\u043E\\u0432\\u0435\\u043A\\u0430 \\u0443\\u0436\\u0435 \\u0435\\u0441\\u0442\\u044C \\u0432 \\u043F\\u043E\\u0441\\u0442\\u0430\\u0432\\u043A\\u0435 \\u0442\\u0430\\u043A\\u043E\\u0435 \\u043D\\u0430\\u0438\\u043C\\u0435\\u043D\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435 \".concat(part_name,\".\"));return;}setNewData(prevData=>_objectSpread(_objectSpread({},prevData),{},{[name]:value}));};const handleChancel=e=>{e.preventDefault();setShown(false);};return/*#__PURE__*/_jsxs(\"div\",{id:blank_id,className:\"inner-card-block\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"inner-card-block-title\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"inner-card-block-name\",children:[/*#__PURE__*/_jsx(\"span\",{children:material_name}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\xAB\",part_name,\"\\xBB\"]})]}),shown?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-input-block\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"new_supplier_id\",children:\"\\u041D\\u043E\\u0432\\u044B\\u0439 \\u043F\\u043E\\u0441\\u0442\\u0430\\u0432\\u0449\\u0438\\u043A:\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"new_supplier_id\",value:newData.new_supplier_id||\"\",onChange:e=>handleChange(e),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",disabled:true,children:\"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u043F\\u043E\\u0441\\u0442\\u0430\\u0432\\u0449\\u0438\\u043A\\u0430\"}),dataAll.map(element=>/*#__PURE__*/_jsx(\"option\",{value:element.supplier_id,children:element.supplier_name},element.supplier_id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"buttons-block\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"grey-button\",type:\"chancel\",onClick:e=>handleChancel(e),children:\"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{className:\"filed-button\",type:\"submit\",children:\"\\u041F\\u0435\\u0440\\u0435\\u043D\\u0430\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\"})]})]})}):\"\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"inner-card-block-buttons\",children:[/*#__PURE__*/_jsx(\"img\",{src:Close,alt:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\",onClick:()=>handleDeleteInnerCard()}),!shown&&/*#__PURE__*/_jsx(\"img\",{src:Change,alt:\"\\u041F\\u0435\\u0440\\u0435\\u043D\\u0430\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\",onClick:()=>setShown(true)})]})]});}","map":{"version":3,"names":["useState","transferBook","returnBook","Blanks_LIMIT","Close","Change","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","InnerCard","_ref","data","dataAll","setDataAll","readerData","countIssuedBlanks","hasIssuedBook","blank_id","material_name","part_name","supplier_id","supplier_name","shown","setShown","newData","setNewData","new_supplier_id","handleDeleteInnerCard","window","confirm","concat","res","location","reload","handleSubmit","e","preventDefault","handleChange","name","value","target","alert","prevData","_objectSpread","handleChancel","id","className","children","onSubmit","htmlFor","onChange","required","disabled","map","element","type","onClick","src","alt"],"sources":["C:/Users/Admin/Desktop/stock/frontend/src/components/ui/InnerCard.jsx"],"sourcesContent":["import { useState } from \"react\"\r\nimport { transferBook, returnBook, Blanks_LIMIT } from \"../../requests\";\r\nimport Close from \"../../images/icon-close.png\"\r\nimport Change from \"../../images/icon-change.png\"\r\n\r\nexport default function InnerCard({data, dataAll, setDataAll, readerData, countIssuedBlanks, hasIssuedBook}) {\r\n    const {blank_id, material_name, part_name} = data;\r\n    const {supplier_id, supplier_name} = readerData;\r\n\r\n    const [shown, setShown] = useState(false);\r\n    const [newData, setNewData] = useState({\r\n        supplier_id: supplier_id,\r\n        new_supplier_id: null,\r\n        blank_id: blank_id,\r\n    });\r\n\r\n    const handleDeleteInnerCard = async () => {\r\n        if (window.confirm(`Вы уверены, что хотите принять заготовку \"${part_name}\" от поставщика ${supplier_name}?`)) {\r\n            const res = await returnBook(newData);\r\n            if(res){\r\n                window.location.reload();\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n    \r\n        const res = await transferBook(newData);\r\n    \r\n        if (res === 200) {\r\n            setShown(false);\r\n            window.location.reload();\r\n        }\r\n    };\r\n\r\n    const handleChange = (e) => {\r\n        const { name, value } = e.target;\r\n\r\n        if(countIssuedBlanks(value) >= Blanks_LIMIT){\r\n            alert(`Количество заготовок в поставке у выбранного человека превышает лимит ${Blanks_LIMIT}.`);\r\n            return;\r\n        }\r\n\r\n        if(hasIssuedBook(value, blank_id)){\r\n            alert(`У выбранного человека уже есть в поставке такое наименование ${part_name}.`);\r\n            return;\r\n        }\r\n\r\n        setNewData((prevData) => ({\r\n            ...prevData,\r\n            [name]: value,\r\n        }));\r\n    };\r\n\r\n    const handleChancel = (e) => {\r\n        e.preventDefault();\r\n        setShown(false);\r\n    }\r\n\r\n    \r\n\r\n    return (\r\n        <div id={blank_id} className=\"inner-card-block\">\r\n            <div className=\"inner-card-block-title\">\r\n                <div className=\"inner-card-block-name\">\r\n                    <span>{material_name}</span>\r\n                    <span>«{part_name}»</span> \r\n                </div>\r\n                {shown?(\r\n                    <>\r\n                        <form onSubmit={handleSubmit}>\r\n                            <div className=\"form-input-block\">\r\n                                <label htmlFor=\"new_supplier_id\">Новый поставщик:</label>\r\n                                <select\r\n                                    name=\"new_supplier_id\"\r\n                                    value={newData.new_supplier_id || \"\"}\r\n                                    onChange={(e) => handleChange(e)}\r\n                                    required\r\n                                >\r\n                                    <option value=\"\" disabled>\r\n                                        Выберите поставщика\r\n                                    </option>\r\n                                    {dataAll.map((element) => (\r\n                                        <option key={element.supplier_id} value={element.supplier_id}>\r\n                                            {element.supplier_name}\r\n                                        </option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n                            <div className=\"buttons-block\">\r\n                                <button className=\"grey-button\" type=\"chancel\" onClick={(e) => handleChancel(e)}>Отменить</button>\r\n                                <button className=\"filed-button\" type=\"submit\">Перенаправить</button>\r\n                            </div>\r\n                        </form>\r\n                    </>\r\n                ):(\"\")}\r\n            </div>\r\n\r\n            <div className=\"inner-card-block-buttons\">\r\n                <img src={Close} alt=\"Удалить\" onClick={() => handleDeleteInnerCard()}/>\r\n                {!shown && (<img src={Change} alt=\"Перенаправить\" onClick={() => setShown(true)}/>)}\r\n            </div>\r\n        </div>\r\n    )\r\n}"],"mappings":"0HAAA,OAASA,QAAQ,KAAQ,OAAO,CAChC,OAASC,YAAY,CAAEC,UAAU,CAAEC,YAAY,KAAQ,gBAAgB,CACvE,MAAO,CAAAC,KAAK,KAAM,6BAA6B,CAC/C,MAAO,CAAAC,MAAM,KAAM,8BAA8B,QAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAEjD,cAAe,SAAS,CAAAC,SAASA,CAAAC,IAAA,CAA4E,IAA3E,CAACC,IAAI,CAAEC,OAAO,CAAEC,UAAU,CAAEC,UAAU,CAAEC,iBAAiB,CAAEC,aAAa,CAAC,CAAAN,IAAA,CACvG,KAAM,CAACO,QAAQ,CAAEC,aAAa,CAAEC,SAAS,CAAC,CAAGR,IAAI,CACjD,KAAM,CAACS,WAAW,CAAEC,aAAa,CAAC,CAAGP,UAAU,CAE/C,KAAM,CAACQ,KAAK,CAAEC,QAAQ,CAAC,CAAG1B,QAAQ,CAAC,KAAK,CAAC,CACzC,KAAM,CAAC2B,OAAO,CAAEC,UAAU,CAAC,CAAG5B,QAAQ,CAAC,CACnCuB,WAAW,CAAEA,WAAW,CACxBM,eAAe,CAAE,IAAI,CACrBT,QAAQ,CAAEA,QACd,CAAC,CAAC,CAEF,KAAM,CAAAU,qBAAqB,CAAG,KAAAA,CAAA,GAAY,CACtC,GAAIC,MAAM,CAACC,OAAO,yNAAAC,MAAA,CAA8CX,SAAS,kFAAAW,MAAA,CAAmBT,aAAa,KAAG,CAAC,CAAE,CAC3G,KAAM,CAAAU,GAAG,CAAG,KAAM,CAAAhC,UAAU,CAACyB,OAAO,CAAC,CACrC,GAAGO,GAAG,CAAC,CACHH,MAAM,CAACI,QAAQ,CAACC,MAAM,CAAC,CAAC,CAC5B,CACJ,CACJ,CAAC,CAED,KAAM,CAAAC,YAAY,CAAG,KAAO,CAAAC,CAAC,EAAK,CAC9BA,CAAC,CAACC,cAAc,CAAC,CAAC,CAElB,KAAM,CAAAL,GAAG,CAAG,KAAM,CAAAjC,YAAY,CAAC0B,OAAO,CAAC,CAEvC,GAAIO,GAAG,GAAK,GAAG,CAAE,CACbR,QAAQ,CAAC,KAAK,CAAC,CACfK,MAAM,CAACI,QAAQ,CAACC,MAAM,CAAC,CAAC,CAC5B,CACJ,CAAC,CAED,KAAM,CAAAI,YAAY,CAAIF,CAAC,EAAK,CACxB,KAAM,CAAEG,IAAI,CAAEC,KAAM,CAAC,CAAGJ,CAAC,CAACK,MAAM,CAEhC,GAAGzB,iBAAiB,CAACwB,KAAK,CAAC,EAAIvC,YAAY,CAAC,CACxCyC,KAAK,2XAAAX,MAAA,CAA0E9B,YAAY,KAAG,CAAC,CAC/F,OACJ,CAEA,GAAGgB,aAAa,CAACuB,KAAK,CAAEtB,QAAQ,CAAC,CAAC,CAC9BwB,KAAK,qUAAAX,MAAA,CAAiEX,SAAS,KAAG,CAAC,CACnF,OACJ,CAEAM,UAAU,CAAEiB,QAAQ,EAAAC,aAAA,CAAAA,aAAA,IACbD,QAAQ,MACX,CAACJ,IAAI,EAAGC,KAAK,EACf,CAAC,CACP,CAAC,CAED,KAAM,CAAAK,aAAa,CAAIT,CAAC,EAAK,CACzBA,CAAC,CAACC,cAAc,CAAC,CAAC,CAClBb,QAAQ,CAAC,KAAK,CAAC,CACnB,CAAC,CAID,mBACIjB,KAAA,QAAKuC,EAAE,CAAE5B,QAAS,CAAC6B,SAAS,CAAC,kBAAkB,CAAAC,QAAA,eAC3CzC,KAAA,QAAKwC,SAAS,CAAC,wBAAwB,CAAAC,QAAA,eACnCzC,KAAA,QAAKwC,SAAS,CAAC,uBAAuB,CAAAC,QAAA,eAClC3C,IAAA,SAAA2C,QAAA,CAAO7B,aAAa,CAAO,CAAC,cAC5BZ,KAAA,SAAAyC,QAAA,EAAM,MAAC,CAAC5B,SAAS,CAAC,MAAC,EAAM,CAAC,EACzB,CAAC,CACLG,KAAK,cACFlB,IAAA,CAAAI,SAAA,EAAAuC,QAAA,cACIzC,KAAA,SAAM0C,QAAQ,CAAEd,YAAa,CAAAa,QAAA,eACzBzC,KAAA,QAAKwC,SAAS,CAAC,kBAAkB,CAAAC,QAAA,eAC7B3C,IAAA,UAAO6C,OAAO,CAAC,iBAAiB,CAAAF,QAAA,CAAC,wFAAgB,CAAO,CAAC,cACzDzC,KAAA,WACIgC,IAAI,CAAC,iBAAiB,CACtBC,KAAK,CAAEf,OAAO,CAACE,eAAe,EAAI,EAAG,CACrCwB,QAAQ,CAAGf,CAAC,EAAKE,YAAY,CAACF,CAAC,CAAE,CACjCgB,QAAQ,MAAAJ,QAAA,eAER3C,IAAA,WAAQmC,KAAK,CAAC,EAAE,CAACa,QAAQ,MAAAL,QAAA,CAAC,+GAE1B,CAAQ,CAAC,CACRnC,OAAO,CAACyC,GAAG,CAAEC,OAAO,eACjBlD,IAAA,WAAkCmC,KAAK,CAAEe,OAAO,CAAClC,WAAY,CAAA2B,QAAA,CACxDO,OAAO,CAACjC,aAAa,EADbiC,OAAO,CAAClC,WAEb,CACX,CAAC,EACE,CAAC,EACR,CAAC,cACNd,KAAA,QAAKwC,SAAS,CAAC,eAAe,CAAAC,QAAA,eAC1B3C,IAAA,WAAQ0C,SAAS,CAAC,aAAa,CAACS,IAAI,CAAC,SAAS,CAACC,OAAO,CAAGrB,CAAC,EAAKS,aAAa,CAACT,CAAC,CAAE,CAAAY,QAAA,CAAC,kDAAQ,CAAQ,CAAC,cAClG3C,IAAA,WAAQ0C,SAAS,CAAC,cAAc,CAACS,IAAI,CAAC,QAAQ,CAAAR,QAAA,CAAC,gFAAa,CAAQ,CAAC,EACpE,CAAC,EACJ,CAAC,CACT,CAAC,CACJ,EAAG,EACL,CAAC,cAENzC,KAAA,QAAKwC,SAAS,CAAC,0BAA0B,CAAAC,QAAA,eACrC3C,IAAA,QAAKqD,GAAG,CAAExD,KAAM,CAACyD,GAAG,CAAC,4CAAS,CAACF,OAAO,CAAEA,CAAA,GAAM7B,qBAAqB,CAAC,CAAE,CAAC,CAAC,CACvE,CAACL,KAAK,eAAKlB,IAAA,QAAKqD,GAAG,CAAEvD,MAAO,CAACwD,GAAG,CAAC,gFAAe,CAACF,OAAO,CAAEA,CAAA,GAAMjC,QAAQ,CAAC,IAAI,CAAE,CAAC,CAAE,EAClF,CAAC,EACL,CAAC,CAEd","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}