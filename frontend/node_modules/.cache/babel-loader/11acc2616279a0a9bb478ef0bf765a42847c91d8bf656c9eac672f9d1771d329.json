{"ast":null,"code":"import _objectSpread from\"C:/Users/Admin/Desktop/stock/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useEffect,useState}from\"react\";import{getBlanks,issueBook,Blanks_LIMIT}from\"../../requests\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function IssueBook(_ref){let{setShown,readerData,countIssuedBlanks,hasIssuedBook}=_ref;const{supplier_id,supplier_name}=readerData;const[newData,setNewData]=useState({supplier_id:supplier_id,blank_id:\"\"});const[BlanksList,setBlanksList]=useState([]);useEffect(()=>{getBlanks(setBlanksList);},[]);const handleChange=e=>{const{name,value}=e.target;if(countIssuedBlanks(supplier_id)>=Blanks_LIMIT){alert(\"\\u041A\\u043E\\u043B\\u0438\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E \\u0437\\u0430\\u0433\\u043E\\u0442\\u043E\\u0432\\u043E\\u043A \\u0432 \\u043F\\u043E\\u0441\\u0442\\u0430\\u0432\\u043A\\u0435 \".concat(supplier_name,\" \\u043F\\u0440\\u0435\\u0432\\u044B\\u0448\\u0430\\u0435\\u0442 \\u043B\\u0438\\u043C\\u0438\\u0442 \").concat(Blanks_LIMIT,\".\"));return;}if(hasIssuedBook(supplier_id,value)){alert(\"\\u0423 \".concat(supplier_name,\" \\u0443\\u0436\\u0435 \\u0435\\u0441\\u0442\\u044C \\u0442\\u0430\\u043A\\u0430\\u044F \\u0437\\u0430\\u0433\\u043E\\u0442\\u043E\\u0432\\u043A\\u0430.\"));return;}setNewData(prevData=>_objectSpread(_objectSpread({},prevData),{},{[name]:value}));};const handleSubmit=async e=>{e.preventDefault();const res=await issueBook(newData);if(res===200){setShown(false);window.location.reload();}};return/*#__PURE__*/_jsxs(\"div\",{className:\"form-block\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u041F\\u043E\\u0441\\u0442\\u0430\\u0432\\u043A\\u0430 \\u0437\\u0430\\u0433\\u043E\\u0442\\u043E\\u0432\\u043A\\u0438\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-select-block\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"blank_id\",children:\"\\u0417\\u0430\\u0433\\u043E\\u0442\\u043E\\u0432\\u043A\\u0430\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"blank_id\",value:newData.blank_id,onChange:e=>handleChange(e),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",disabled:true,children:\"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0437\\u0430\\u0433\\u043E\\u0442\\u043E\\u0432\\u043A\\u0443\"}),BlanksList.map(element=>/*#__PURE__*/_jsxs(\"option\",{value:element.blank_id,children:[element.material_name,\" - \",element.part_name]},element.blank_id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"buttons-block\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"grey-button\",type:\"button\",onClick:()=>setShown(false),children:\"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{className:\"filed-button\",type:\"submit\",children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C\"})]})]})]});}","map":{"version":3,"names":["useEffect","useState","getBlanks","issueBook","Blanks_LIMIT","jsx","_jsx","jsxs","_jsxs","IssueBook","_ref","setShown","readerData","countIssuedBlanks","hasIssuedBook","supplier_id","supplier_name","newData","setNewData","blank_id","BlanksList","setBlanksList","handleChange","e","name","value","target","alert","concat","prevData","_objectSpread","handleSubmit","preventDefault","res","window","location","reload","className","children","onSubmit","htmlFor","onChange","required","disabled","map","element","material_name","part_name","type","onClick"],"sources":["C:/Users/Admin/Desktop/stock/frontend/src/components/forms/IssueBook.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { getBlanks, issueBook, Blanks_LIMIT} from \"../../requests\";\r\n\r\nexport default function IssueBook({ setShown, readerData, countIssuedBlanks, hasIssuedBook }) {\r\n    const { supplier_id, supplier_name} = readerData;\r\n\r\n    const [newData, setNewData] = useState({\r\n        supplier_id: supplier_id,\r\n        blank_id: \"\",\r\n    })\r\n    const [BlanksList, setBlanksList] = useState([]);\r\n\r\n    useEffect(() => {\r\n        getBlanks(setBlanksList);\r\n    }, []);\r\n\r\n    const handleChange = (e) => {\r\n        const { name, value } = e.target;\r\n\r\n        if(countIssuedBlanks(supplier_id) >= Blanks_LIMIT){\r\n            alert(`Количество заготовок в поставке ${supplier_name} превышает лимит ${Blanks_LIMIT}.`);\r\n            return;\r\n        }\r\n\r\n        if(hasIssuedBook(supplier_id, value)){\r\n            alert(`У ${supplier_name} уже есть такая заготовка.`);\r\n            return;\r\n        }\r\n\r\n        setNewData((prevData) => ({\r\n            ...prevData,\r\n            [name]: value,\r\n        }));\r\n    };\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n\r\n        const res = await issueBook(newData);\r\n        if (res === 200) {\r\n            setShown(false);\r\n            window.location.reload();\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"form-block\">\r\n            <h3>Поставка заготовки</h3>\r\n            <form onSubmit={handleSubmit}>\r\n                <div className=\"form-select-block\">\r\n                    <label htmlFor=\"blank_id\">Заготовка</label>\r\n                    <select\r\n                        name='blank_id'\r\n                        value={newData.blank_id}\r\n                        onChange={(e) => handleChange(e)}\r\n                        required\r\n                    >\r\n                        <option value=\"\" disabled>\r\n                            Выберите заготовку\r\n                        </option>\r\n                        {BlanksList.map((element) => (\r\n                            <option key={element.blank_id} value={element.blank_id}>\r\n                                {element.material_name} - {element.part_name}\r\n                            </option>\r\n                        ))}\r\n                    </select>\r\n                </div>\r\n\r\n                <div className=\"buttons-block\">\r\n                    <button className=\"grey-button\" type=\"button\" onClick={() => setShown(false)}>Отменить</button>\r\n                    <button className=\"filed-button\" type=\"submit\">Добавить</button>\r\n                </div>\r\n            </form>\r\n        </div>\r\n    );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}